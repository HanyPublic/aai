ù
\D:\Projects\aksaty-api-main\aksaty-api-main\src\Aksaty.Infra.CrossCutting.Bus\InMemoryBus.cs
	namespace 	
Aksaty
 
. 
Infra 
. 
CrossCutting #
.# $
Bus$ '
{		 
public

 

sealed

 
class

 
InMemoryBus

 #
:

$ %
IMediatorHandler

& 6
{ 
private 
readonly 
	IMediator "
	_mediator# ,
;, -
private 
readonly 
IEventStore $
_eventStore% 0
;0 1
public 
InMemoryBus 
( 
IEventStore &

eventStore' 1
,1 2
	IMediator3 <
mediator= E
)E F
{ 	
_eventStore 
= 

eventStore $
;$ %
	_mediator 
= 
mediator  
;  !
} 	
public 
async 
Task 
PublishEvent &
<& '
T' (
>( )
() *
T* +
@event, 2
)2 3
where4 9
T: ;
:< =
Event> C
{ 	
if 
( 
! 
@event 
. 
MessageType #
.# $
Equals$ *
(* +
$str+ ?
)? @
)@ A
_eventStore 
? 
. 
Save !
(! "
@event" (
)( )
;) *
await 
	_mediator 
. 
Publish #
(# $
@event$ *
)* +
;+ ,
} 	
public 
async 
Task 
< 
ValidationResult *
>* +
SendCommand, 7
<7 8
T8 9
>9 :
(: ;
T; <
command= D
)D E
whereF K
TL M
:N O
CommandP W
{ 	
return 
await 
	_mediator "
." #
Send# '
(' (
command( /
)/ 0
;0 1
}   	
}!! 
}"" 